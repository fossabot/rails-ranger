# Rails Ranger
### Exploring the routes and paths of Rails APIs
> This library development is in an early stage and the API is unstable

#### [Github Repository](https://github.com/victor-am/rails-ranger) | [Documentation](https://victor-am.github.io/rails-ranger)

[![npm version](https://badge.fury.io/js/rails-ranger.svg)](https://badge.fury.io/js/rails-ranger)
[![Travis build status](http://img.shields.io/travis/victor-am/rails-ranger.svg?style=flat)](https://travis-ci.org/victor-am/rails-ranger)
[![Test Coverage](https://codeclimate.com/github/victor-am/rails-ranger/badges/coverage.svg)](https://codeclimate.com/github/victor-am/rails-ranger)
[![Dependency Status](https://david-dm.org/victor-am/rails-ranger.svg)](https://david-dm.org/victor-am/rails-ranger)
[![devDependency Status](https://david-dm.org/victor-am/rails-ranger/dev-status.svg)](https://david-dm.org/victor-am/rails-ranger#info=devDependencies)
[![Stories in Ready](https://badge.waffle.io/victor-am/rails-ranger.png?label=ready&title=Ready)](https://waffle.io/victor-am/rails-ranger?utm_source=badge)

Rails Ranger is a thin layer on top of [Axios](https://github.com/mzabriskie/axios), which gives you an opinionated interface to query APIs built with Ruby on Rails.

## Main features
- URL building following Ruby on Rails routes conventions
- Automatic transformation of camelCase into snake_case and back to camelCase when exchanging data between the front-end and the API

## Installation
```bash
npm install --save rails-ranger
```

**or**

```bash
yarn add rails-ranger
```
<br>

## How does it work?

The following example illustrates a simple usage of the library:

```javascript
// api-client.js

import RailsRanger from 'rails-ranger'

const config = {
  axios: { baseURL: 'http://api.myapp.com' }
}

export default new RailsRanger(config)
```

```javascript
// some-front-end-component.js

import api from 'api-client'

api.list('users').then((response) => {
  const users = response.data
})
```

The `list` function makes a request to the **index** path of the **users** resource, following Rails routing conventions. This means a `GET` request to the `/users` path.

Also we converted the *snake_cased* JSON generated by Ruby on Rails automaticaly to *camelCase*, as preferred in Javascript.

> **Observation:** you can use `api.index('users')` as well. The `list` function is just an alias for it.
<br>

### A slightly more advanced example:

```javascript
api.show('users', { id: 1, someParameter: false })
// => GET request to /users/1?some_parameter=false
```
<br>

## Options
As the first argument when creating a new instance of Rails Ranger you can pass an object of options to customize the behavior of the client.

### dataTransform
**default: true**

By default RailsRanger will convert camelCased keys in your jsons to snake_case when sending a request to Rails, and will convert the Rails response back from snake_case to camelCase for better usage within your javascript code.

You can disable this behavior by setting `dataTransform` to false:

```javascript
const api = new RailsRanger({ dataTransform: false })
```

---
### axios
**default: {}**

Any object passed to the `axios` option will be handled to **Axios**.
Here an example using the `baseUrl` configuration of Axios:

```javascript
const api = new RailsRanger({ axios: { baseUrl: 'http://myapp.com/api/v1' } })

api.list('users')
// => GET request to http://myapp.com/api/users
```

#### See more configuration options in the [Axios documentation](https://github.com/mzabriskie/axios#request-config)
<br>

## Using Rails Ranger just for building routes
You don't need to use Rails Ranger as an ajax client if you don't want to. It can also be used just to generate the routes from your resources. Using the library this way you can do the following:

```javascript
import { RouteBuilder } from RailsRanger
const routeFor = new RouteBuilder

routeFor.create('users', { name: 'John' })
// => { path: '/users', params: { name: 'John' }, method: 'post' }

routeFor.show('users', { id: 1, hidePassword: true })
// => { path: '/users/1?hide_password=true', params: {}, method: 'get' }

routeFor.get('/:api/documentation', { api: 'v1', page: 3 })
// => { path: 'v1/documentation?page=3', params: {}, method: 'get' }
```

## Available actions

- list/index
- show
- new
- create
- edit
- update
<br>

## Available HTTP methods

### GET
```javascript
api.get('users/:id', { id: 1, hidePassword: true })
// => GET request to users/1&hide_password=true
```

### POST
```javascript
api.post('users/:id', { id: 1, name: 'John' })
// => POST request to users/1 with a JSON payload containing: { "name": "John" }
```

### PATCH
```javascript
api.patch('users/:id', { id: 1, name: 'John' })
// => PATCH request to users/1 with a JSON payload containing: { "name": "John" }
```

### PUT
```javascript
api.put('users/:id', { id: 1, name: 'John' })
// => PUT request to users/1 with a JSON payload containing: { "name": "John" }
```

### DELETE
```javascript
api.delete('users/:id', { id: 1, hidePassword: true })
// => DELETE request to users/1&hide_password=true
```
<br>
